<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script th:src="@{/webjars/jquery/1.11.1/jquery.min.js}"></script>
    <title th:text="|PZ ${zone.name} |">Zone</title>
</head>
<body class="d-flex h-100 text-center">
<div class="container">
    <div class="starter-template text-center py-3 px-3">
        <img th:src="@{/img/quickLogo.png}" width=40% alt="" loading="lazy" onclick="location.href='/zones'">
    </div>
    <section class="album py-3 bg-light" th:object="${zone}">
        <div>
            <p th:text="|Your Zone *{name} has |">
            <p th:text="|*{totalParkingSpots}|" id="totalSpots"></p>
            <p th:text="|parking spots:|"></p>
        </div>
        <form action="#" th:action="@{/zones/update}" th:object="${zone}" method="post">
            <input type="hidden" th:field="*{id}" id="zoneid">
            <input type="hidden" th:field="*{totalParkingSpots}" id="totalParkingSpots">
            <input type="hidden" th:field="*{name}" id="name">
            <input type="hidden" th:field="*{parkingSpots}" id="parkingSpots">
            <div th:each="spot : *{parkingSpots}">
                <input th:if="${spot.parkingType == T(nl.conspect.drivedok.model.ParkingType).NORMAL}"
                       th:value="${spot.quantity}"
                       th:id="${spot.parkingType}"
                       readonly
                       id="placeholderNormal"/>
                <label th:if="${spot.parkingType == T(nl.conspect.drivedok.model.ParkingType).NORMAL}"
                       th:for="${spot.parkingType}"
                       th:text="| ${spot.parkingType} spots |"
                       for="placeholderNormal"
                ></label>
                <input th:if="${spot.parkingType != T(nl.conspect.drivedok.model.ParkingType).NORMAL}"
                       type="text"
                       th:value="${spot.quantity}"
                       th:id="${spot.parkingType}"
                       id="placeholder"/>
                <label th:if="${spot.parkingType != T(nl.conspect.drivedok.model.ParkingType).NORMAL}"
                       th:for="${spot.parkingType}"
                       th:text="| ${spot.parkingType} spots |"
                       for="placeholder"
                ></label>
            </div>
            <input id="submit-new-period" type="submit" value="update">
        </form>
        <div class="album py-3 bg-light">
            <button class="btn btn-warning" onclick="location.href='/zones'">Go to overview</button>
        </div>
        <script th:inline="javascript">
        // id = ParkingType
        /*<![CDATA[*/
        console.log(/*[[${zone}]]*/)
        const normalInput = document.getElementById("NORMAL");
        const disabledInput = document.getElementById("DISABLED");
        const electricInput = document.getElementById("ELECTRIC");
        console.log(normalInput);
        console.log(disabledInput);
        console.log(electricInput);
        const totalParkingSpotsValue = Number(document.getElementById("totalParkingSpots").value);
        // on pageload
        console.log(`totalParkingSpotsValue is: ${totalParkingSpotsValue} en het is een ${typeof totalParkingSpotsValue}`);
        disabledInput.addEventListener("blur", () => recalculate());
        electricInput.addEventListener("blur", () => recalculate())
        const recalculate = () => {
            let currentDisabledInputValue = parseInt(disabledInput.value);
            let currentElectricInputValue = parseInt(electricInput.value);
            let newNormalInputValue = totalParkingSpotsValue - currentDisabledInputValue - currentElectricInputValue;
            console.log(
                `totalParkingSpots ${totalParkingSpotsValue}
            - disabled ${currentDisabledInputValue}
            - electric ${currentElectricInputValue}
            = ${newNormalInputValue}`)
            normalInput.setAttribute("value", newNormalInputValue.toString());
            disabledInput.setAttribute("value", disabledInput.value);
            electricInput.setAttribute("value", electricInput.value);
            console.log(`Changed normal input value to ${normalInput.value}`);
        }
    </script>
    </section>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>

</body>
</html>